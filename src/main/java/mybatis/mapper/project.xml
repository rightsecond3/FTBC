<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper     PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"     "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mybatis.mapper.ProjectMapper">
   <resultMap id="summer" type="HashMap">
      <result property="pjo_img_result " column="pjo_img_result " jdbcType="CLOB" javaType="java.lang.String" />
      <result property="pjo_profile_img_result " column="pjo_profile_img_result " jdbcType="CLOB" javaType="java.lang.String" />
      <result property="editordata " column="editordata" jdbcType="CLOB" javaType="java.lang.String" />
   </resultMap>
   <insert id="projectcreate" parameterType="map">
   		INSERT INTO project (PROJECT_CODE,SUBCAT_CODE,MEM_EMAIL,PJ_ISEDIT,PJ_PUBLICKEY,PJ_PRIVATEKEY,PJ_ACCOUNT,PJ_STAT,PJ_ISSUCCESS)
			values (#{PROJECT_CODE},#{pjo_category_select_result},#{mem_email},1,#{PJ_PUBLICKEY},#{PJ_PRIVATEKEY},1,1,1)
   </insert>
   <insert id="storytellinginsert" parameterType="map">
   		INSERT INTO storytelling (project_code,st_story)
   				values(#{PROJECT_CODE},#{editordata})
   </insert>
   <insert id="pjoutlineinsert" parameterType="map">
   		INSERT INTO pjoutline (project_code,pjo_introduce,pjo_longtitle,pjo_shorttitle,pjo_img,pjo_summary,Ol_category,pjo_pageaddr)
   				values(#{PROJECT_CODE},#{pjo_introduction_edit_textarea},#{long_title},#{short_title},
   				#{pjo_img_result},#{pjo_summary_edit_text},1,#{pjo_page_text})
   </insert>
   <insert id="fundinginsert" parameterType="map">
   		INSERT INTO funding(project_code,fd_targetmoney,fd_deadline)
   				values(#{PROJECT_CODE},1,1)<!-- 펀딩 인서트 -->
   </insert>
   <select id="proc_procode" parameterType="map" statementType="CALLABLE">
      {call pro_project_code(#{pjo_category_select_result, mode=IN, jdbcType=VARCHAR, javaType=java.lang.String}
      ,#{PROJECT_CODE, mode=OUT, jdbcType=VARCHAR, javaType=java.lang.String}
      )}
   </select>
   <select id="allProjects" resultType="vo.ProjectVO">
	   	select project.project_code,subcat_code,mem.mem_email,pjo_img,pjo_longtitle,mem_nickname
		  from project,pjoutline,mem
		 where project.project_code = pjoutline.project_code
		 and project.mem_email = mem.mem_email
		 and pj_stat = 1
   </select>
   <select id="keywordProjects" parameterType="String" resultType="vo.ProjectVO">
	   	select project.project_code,subcat_code,mem.mem_email,pjo_img,pjo_longtitle,mem_nickname
		  from project,pjoutline,mem
		 where project.project_code = pjoutline.project_code
		   and project.mem_email = mem.mem_email
		   and pjo_longtitle in #{value}
		   and pj_stat = 1
   </select>
   <select id="categoryProjects" parameterType="String" resultType="vo.ProjectVO">
	   	select project.project_code,mem.subcat_code,mem.mem_email,pjo_img,pjo_longtitle,mem_nickname
		  from project,pjoutline,mem,subcat
		 where project.project_code = pjoutline.project_code
		   and project.mem_email = mem.mem_email
		   and maincat_name = #{value}
		   and pj_stat = 1
   </select>
   <select id="fundedProject" parameterType="List" resultType="vo.ProjectVO">
	   	select project.project_code,subcat_code,mem.mem_email,pjo_img,pjo_longtitle,mem_nickname
		  from project,pjoutline,mem
		 where project.project_code in
		 	<foreach collection="list" item="item" index="index"
		 		open="()" separator="," close=")">
		 		#{item}
		 	</foreach>
		 and project.mem_email = mem.mem_email
		 	and pj_stat = 1
   </select>
    <select id="myProjects" parameterType="String" resultType="vo.ProjectVO">
	   	select project.project_code,subcat_code,mem.mem_email,pjo_img,pjo_longtitle,mem_nickname
		  from project,pjoutline,mem
		 where project.mem_email = mem.mem_email
		   and project.project_code = pjoutline.project_code
		   and project.mem_email = #{value}
		   and pj_stat = 1
   </select>
   <select id="projectDetail" parameterType="String" resultType="vo.ProjectVO">
		select 
		  PROJECT_CODE,PJ_PUBLICKEY,PJO_SUMMARY,PJO_PAGEADDR,PJO_INTRODUCE,PJO_SHORTTITLE,PJO_LONGTITLE,PJO_IMG,ST_STORY,subcat_code,FD_TARGETMONEY,FD_DEADLINE,subcat_name
		from project p NATURAL JOIN pjoutline o NATURAL JOIN funding f NATURAL JOIN storytelling s NATURAL JOIN subcat
		where pj_stat = 1  
		 and project_code = #{value}  
   </select>
   <select id="getGift" parameterType="String" resultType="map">
   		select 
   			 GIFT_UNITMONEY,GIFT_NAME,GIFT_INCLUDE,GIFT_EXPLANATION,GIFT_DELIVERYDATE,GIFT_LIMITED       
  				,PROJECT_CODE,GIFT_CODE    
  		from gift
  		where project_code = #{value}    
   </select>
   <select id="getGiftOption" parameterType="String" resultType="map">
   		select
   			GOP_OPTION,GOP_AMMOUNT,GOP_CODE,GIFT_CODE,GOP_DESCRIPTION
   		  from giftoption
   		  where gift_code in
   		  <foreach collection="list" item="item" index="index"
		 		open="()" separator="," close=")">
		 		#{item}
		 </foreach>
			and 1=1
   </select>
</mapper>





















